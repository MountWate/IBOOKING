{"remainingRequest":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\thread-loader\\dist\\cjs.js!F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\babel-loader\\lib\\index.js!F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Fudan course\\software_management\\iBooking\\client\\src\\views\\MyReserve.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\src\\views\\MyReserve.vue","mtime":1715762069694},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\babel.config.js","mtime":1684482910000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1684483040000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1684483040000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgTWFwTG9hZGVyIGZyb20gIi4uL3V0aWxzL2dhb2RlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJNeVJlc2VydmUiLAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFibGVEYXRhVG9kYXk6IFtdLAogICAgICB0YWJsZURhdGFGdXR1cmU6IFtdLAogICAgICB0YWJsZURhdGFFeHBpcmVkOiBbXSwKICAgICAgcGFnZU51bTogMSwKICAgICAgcGFnZVNpemU6IC0xLAogICAgICB1c2VybmFtZTogSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlciIpKS51c2VybmFtZSwKICAgICAgZnVsbHNjcmVlbkxvYWRpbmc6IGZhbHNlCiAgICB9OwogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmxvYWQoKTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBoYW5kbGVDYW5jZWwoaWQpIHsKICAgICAgdGhpcy5yZXF1ZXN0LnBvc3QoIi9yZXNlcnZlL2NhbmNlbF9yZXNlcnZlIiwgewogICAgICAgIGlkOiBpZAogICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgY29uc29sZS5sb2cocmVzKTsKCiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMjAwJykgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLlj5bmtojmiJDlip8iKTsKICAgICAgICAgIHRoaXMubG9hZCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLlj5bmtojlpLHotKUiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICBsb2FkKCkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgIHRoaXMucmVxdWVzdC5nZXQoIi9yZXNlcnZlL2NoZWNrX3Jlc2VydmUiLCB7CiAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgcGFnZU51bTogdGhpcy5wYWdlTnVtLAogICAgICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwKICAgICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUKICAgICAgICAgIH0KICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICB0aGlzLnRhYmxlRGF0YVRvZGF5ID0gW107CiAgICAgICAgICB0aGlzLnRhYmxlRGF0YUZ1dHVyZSA9IFtdOwogICAgICAgICAgdGhpcy50YWJsZURhdGFFeHBpcmVkID0gW107CiAgICAgICAgICBsZXQgdGFibGVEYXRhID0gcmVzLmRhdGEucmVjb3JkczsKICAgICAgICAgIGxldCB0b3RhbCA9IHRhYmxlRGF0YS5sZW5ndGg7CgogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbDsgaSsrKSB7CiAgICAgICAgICAgIGlmICh0YWJsZURhdGFbaV0uYnJlYWtDb250cmFjdCA9PT0gdHJ1ZSB8fCB0YWJsZURhdGFbaV0uY2FuY2xlID09PSB0cnVlIHx8IHRhYmxlRGF0YVtpXS5jaGVja0luVGltZSA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgIHRoaXMudGFibGVEYXRhRXhwaXJlZC5wdXNoKHRhYmxlRGF0YVtpXSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGFibGVEYXRhW2ldLmJyZWFrQ29udHJhY3QgPT09IGZhbHNlICYmIHRhYmxlRGF0YVtpXS5jYW5jbGUgPT09IGZhbHNlICYmIHRhYmxlRGF0YVtpXS5jaGVja0luVGltZSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSB0YWJsZURhdGFbaV0uc3RhcnRUaW1lLnNwbGl0KCIgIilbMF07CiAgICAgICAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgICAgIGNvbnN0IHllYXIgPSBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpOwogICAgICAgICAgICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICAgIGNvbnN0IGRheSA9IFN0cmluZyhjdXJyZW50RGF0ZS5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsICcwJyk7CiAgICAgICAgICAgICAgY29uc3QgdG9kYXlEYXRlID0gYCR7eWVhcn0tJHttb250aH0tJHtkYXl9YDsKCiAgICAgICAgICAgICAgaWYgKHN0YXJ0VGltZSA9PT0gdG9kYXlEYXRlKSB7CiAgICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YVRvZGF5LnB1c2godGFibGVEYXRhW2ldKTsKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy50YWJsZURhdGFGdXR1cmUucHVzaCh0YWJsZURhdGFbaV0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlU2lnbkluKHJvdykgewogICAgICB0aGlzLmZ1bGxzY3JlZW5Mb2FkaW5nID0gdHJ1ZTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGNvbnN0IGN1cnJlbnRIb3VycyA9IGN1cnJlbnREYXRlLmdldEhvdXJzKCk7CiAgICAgICAgY29uc3QgY3VycmVudE1pbnV0ZXMgPSBjdXJyZW50RGF0ZS5nZXRNaW51dGVzKCk7CiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcm93LnN0YXJ0VGltZS5zcGxpdCgiICIpWzFdOwogICAgICAgIGNvbnN0IHN0YXJ0SG91ciA9IHN0YXJ0VGltZS5zcGxpdCgiOiIpWzBdOwogICAgICAgIGNvbnN0IHN0YXJ0TWludXRlID0gc3RhcnRUaW1lLnNwbGl0KCI6IilbMV07CiAgICAgICAgY29uc3QgdGltZVZhbHVlMSA9IHBhcnNlSW50KGN1cnJlbnRIb3VycywgMTApICogNjAgKyBwYXJzZUludChjdXJyZW50TWludXRlcywgMTApOwogICAgICAgIGNvbnN0IHRpbWVWYWx1ZTIgPSBwYXJzZUludChzdGFydEhvdXIsIDEwKSAqIDYwICsgcGFyc2VJbnQoc3RhcnRNaW51dGUsIDEwKTsKICAgICAgICBjb25zdCBtaW51dGVEaWZmZXJlbmNlID0gdGltZVZhbHVlMSAtIHRpbWVWYWx1ZTI7CgogICAgICAgIGlmIChtaW51dGVEaWZmZXJlbmNlIDwgLTUpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuacquWIsOetvuWIsOaXtumXtO+8jOivt+WcqOW8gOWni+aXtumXtOWJjeS6lOWIhumSn+iHs+WQjuWNgeS6lOWIhumSn+WGheetvuWIsCIpOwogICAgICAgICAgdGhpcy5mdWxsc2NyZWVuTG9hZGluZyA9IGZhbHNlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZygi5byA5aeL5a6a5L2N77yBIik7CiAgICAgICAgICBNYXBMb2FkZXIoKS50aGVuKGlzV2l0aGluRGlzdGFuY2UgPT4gewogICAgICAgICAgICBpZiAoaXNXaXRoaW5EaXN0YW5jZSkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJvdy5pZCk7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdC5wb3N0KCIvcmVzZXJ2ZS9jb25maXJtX3Jlc2VydmUiLCB7CiAgICAgICAgICAgICAgICBpZDogcm93LmlkCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCLnrb7liLDlpLHotKXvvIzmgqjkuI3lnKjmjIflrprkvY3nva7ojIPlm7TlhoUiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09ICcyMDAnKSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLnrb7liLDmiJDlip8iKTsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5sb2FkKCk7IC8vIOmHjeaWsOWKoOi9veaVsOaNruS7peabtOaWsOeVjOmdogogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigi562+5Yiw5aSx6LSlIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICB0aGlzLmZ1bGxzY3JlZW5Mb2FkaW5nID0gZmFsc2U7IC8vIOWcqOmHjeaWsOWKoOi9veaVsOaNruWujOaIkOWQjuiuvue9ruS4umZhbHNlCiAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAi562+5Yiw5aSx6LSlIik7CiAgICAgICAgICAgIHRoaXMuZnVsbHNjcmVlbkxvYWRpbmcgPSBmYWxzZTsgLy8g56Gu5L+d5Zyo5omA5pyJ5pON5L2c5a6M5oiQ5ZCO6K6+572u5Li6ZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgMjAwMCk7CiAgICB9LAoKICAgIGhhbmRsZVJlRWRpdChyb3cpIHsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9OZXdSZXNlcnZlIik7CiAgICAgIGNvbnNvbGUubG9nKHJvdy5zaXRJZCk7CiAgICB9CgogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgIA;AACA;EACAA,iBADA;;EAEAC;IACA;MACAC,kBADA;MAEAC,mBAFA;MAGAC,oBAHA;MAIAC,UAJA;MAKAC,YALA;MAMAC,2DANA;MAOAC;IAPA;EASA,CAZA;;EAaAC;IACA;EACA,CAfA;;EAgBAC;IACAC;MACA;QACAC;MADA,GAEAC,IAFA,CAEAC;QACAC;;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;MACA,CAVA;IAWA,CAbA;;IAcAC;MACA;QACA;UACAC;YACAZ,qBADA;YAEAC,uBAFA;YAGAC;UAHA;QADA,GAMAM,IANA,CAMAC;UACA;UACA;UACA;UACA;UACA;;UACA;YACA;cACA;YACA,CAFA,MAEA;cACA;cACA;cACA;cACA;cACA;cACA;;cACA;gBACA;cACA,CAFA,MAEA;gBACA;cACA;YACA;UACA;;UACAI;QACA,CA9BA,EA8BAC,KA9BA,CA8BAC;UACAC;QACA,CAhCA;MAiCA,CAlCA;IAmCA,CAlDA;;IAmDAC;MACA;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;UACA;UACA;QACA,CAHA,MAGA;UACAR;UACAS;YACA;cACAT;cACA;gBACAH;cADA;YAGA,CALA,MAKA;cACA;YACA;UACA,CATA,EASAC,IATA,CASAC;YACA;cACA;cACA,mBAFA,CAEA;YACA,CAHA,MAGA;cACA;YACA;UACA,CAhBA,EAgBAD,IAhBA,CAgBA;YACA,+BADA,CACA;UACA,CAlBA,EAkBAM,KAlBA,CAkBAC;YACA;YACA,+BAFA,CAEA;UACA,CArBA;QAsBA;MACA,CAvCA,EAuCA,IAvCA;IAwCA,CA7FA;;IA8FAK;MACA;MACAV;IACA;;EAjGA;AAhBA","names":["name","data","tableDataToday","tableDataFuture","tableDataExpired","pageNum","pageSize","username","fullscreenLoading","created","methods","handleCancel","id","then","res","console","load","params","resolve","catch","error","reject","handleSignIn","setTimeout","MapLoader","handleReEdit"],"sourceRoot":"src/views","sources":["MyReserve.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>今日预约</span>\r\n            </div>\r\n            <el-table :data=\"tableDataToday\" border stripe>\r\n\r\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"sitId\" label=\"座位号\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\r\n                </el-table-column>\r\n\r\n                <el-table-column prop=\"option\" label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button type=\"primary\" v-loading.fullscreen.lock=\"fullscreenLoading\"\r\n                            @click=\"handleSignIn(scope.row)\">签到 <i class=\"el-icon-s-claim\"></i></el-button>\r\n\r\n                        <el-popconfirm class=\"ml-5\" confirm-button-text='确定' cancel-button-text='我再想想' icon=\"el-icon-info\"\r\n                            icon-color=\"red\" title=\"您确定取消预约吗？\" @confirm=\"handleCancel(scope.row.id)\">\r\n                            <el-button type=\"danger\" slot=\"reference\">取消预约 <i\r\n                                    class=\"el-icon-remove-outline\"></i></el-button>\r\n                        </el-popconfirm>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n        </el-card>\r\n\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>未来预约</span>\r\n\r\n            </div>\r\n\r\n            <el-table :data=\"tableDataFuture\" border stripe>\r\n\r\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"sitId\" label=\"座位号\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\r\n                </el-table-column>\r\n\r\n                <el-table-column prop=\"option\" label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n\r\n                        <el-popconfirm class=\"ml-5\" confirm-button-text='确定' cancel-button-text='我再想想' icon=\"el-icon-info\"\r\n                            icon-color=\"red\" title=\"您确定取消预约吗？\" @confirm=\"handleCancel(scope.row.id)\">\r\n\r\n                            <el-button type=\"danger\" slot=\"reference\">取消预约 <i\r\n                                    class=\"el-icon-remove-outline\"></i></el-button>\r\n\r\n                        </el-popconfirm>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n        </el-card>\r\n\r\n        <el-card class=\"box-card\" v-if=\"userRole === 'ROLE_ADMIN'\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>已过期预约</span>\r\n\r\n            </div>\r\n            <el-table :data=\"tableDataExpired\" border stripe>\r\n\r\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"sitId\" label=\"座位号\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\r\n                </el-table-column>\r\n                <el-table-column label=\"是否签到\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-switch v-model=\"scope.row.checkInTime\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\r\n                            disabled></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"是否取消\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-switch v-model=\"scope.row.cancle\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\r\n                            disabled></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"是否违约\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-switch v-model=\"scope.row.breakContract\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\r\n                            disabled></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"option\" label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n                        <router-link :to=\"{name: '座位预定', params: {id: scope.row.sitId}}\">\r\n                            <el-button>\r\n                                再次预约 \r\n                                <i class=\"el-icon-s-check\"></i>\r\n                            </el-button>\r\n                        </router-link>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n        </el-card>\r\n    </div>\r\n</template>\r\n  \r\n<script>\r\nimport MapLoader from \"../utils/gaode\"\r\nexport default {\r\n    name: \"MyReserve\",\r\n    data() {\r\n        return {\r\n            tableDataToday: [],\r\n            tableDataFuture: [],\r\n            tableDataExpired: [],\r\n            pageNum: 1,\r\n            pageSize: -1,\r\n            username: JSON.parse(localStorage.getItem(\"user\")).username,\r\n            fullscreenLoading: false,\r\n        }\r\n    },\r\n    created() {\r\n        this.load()\r\n    },\r\n    methods: {\r\n        handleCancel(id) {\r\n            this.request.post(\"/reserve/cancel_reserve\", {\r\n                id: id\r\n            }).then(res => {\r\n                console.log(res)\r\n                if (res.code === '200') {\r\n                    this.$message.success(\"取消成功\")\r\n                    this.load()\r\n                } else {\r\n                    this.$message.error(\"取消失败\")\r\n                }\r\n            })\r\n        },\r\n        load() {\r\n            return new Promise((resolve, reject) => {\r\n                this.request.get(\"/reserve/check_reserve\", {\r\n                    params: {\r\n                        pageNum: this.pageNum,\r\n                        pageSize: this.pageSize,\r\n                        username: this.username\r\n                    }\r\n                }).then(res => {\r\n                    this.tableDataToday = [];\r\n                    this.tableDataFuture = [];\r\n                    this.tableDataExpired = [];\r\n                    let tableData = res.data.records;\r\n                    let total = tableData.length;\r\n                    for (let i = 0; i < total; i++) {\r\n                        if (tableData[i].breakContract === true || tableData[i].cancle === true || tableData[i].checkInTime === true) {\r\n                            this.tableDataExpired.push(tableData[i]);\r\n                        } else if (tableData[i].breakContract === false && tableData[i].cancle === false && tableData[i].checkInTime === false) {\r\n                            const startTime = tableData[i].startTime.split(\" \")[0];\r\n                            const currentDate = new Date();\r\n                            const year = currentDate.getFullYear();\r\n                            const month = String(currentDate.getMonth() + 1).padStart(2, '0');\r\n                            const day = String(currentDate.getDate()).padStart(2, '0');\r\n                            const todayDate = `${year}-${month}-${day}`;\r\n                            if (startTime === todayDate) {\r\n                                this.tableDataToday.push(tableData[i]);\r\n                            } else {\r\n                                this.tableDataFuture.push(tableData[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                    resolve();\r\n                }).catch(error => {\r\n                    reject(error);\r\n                });\r\n            });\r\n        },\r\n        handleSignIn(row) {\r\n            this.fullscreenLoading = true;\r\n            setTimeout(() => {\r\n                const currentDate = new Date();\r\n                const currentHours = currentDate.getHours();\r\n                const currentMinutes = currentDate.getMinutes();\r\n                const startTime = row.startTime.split(\" \")[1];\r\n                const startHour = startTime.split(\":\")[0];\r\n                const startMinute = startTime.split(\":\")[1];\r\n                const timeValue1 = parseInt(currentHours, 10) * 60 + parseInt(currentMinutes, 10);\r\n                const timeValue2 = parseInt(startHour, 10) * 60 + parseInt(startMinute, 10);\r\n                const minuteDifference = timeValue1 - timeValue2;\r\n\r\n                if (minuteDifference < -5) {\r\n                    this.$message.error(\"未到签到时间，请在开始时间前五分钟至后十五分钟内签到\");\r\n                    this.fullscreenLoading = false;\r\n                } else {\r\n                    console.log(\"开始定位！\");\r\n                    MapLoader().then(isWithinDistance => {\r\n                        if (isWithinDistance) {\r\n                            console.log(row.id);\r\n                            return this.request.post(\"/reserve/confirm_reserve\", {\r\n                                id: row.id\r\n                            });\r\n                        } else {\r\n                            throw new Error(\"签到失败，您不在指定位置范围内\");\r\n                        }\r\n                    }).then(res => {\r\n                        if (res.code === '200') {\r\n                            this.$message.success(\"签到成功\");\r\n                            return this.load(); // 重新加载数据以更新界面\r\n                        } else {\r\n                            throw new Error(\"签到失败\");\r\n                        }\r\n                    }).then(() => {\r\n                        this.fullscreenLoading = false; // 在重新加载数据完成后设置为false\r\n                    }).catch(error => {\r\n                        this.$message.error(error.message || \"签到失败\");\r\n                        this.fullscreenLoading = false; // 确保在所有操作完成后设置为false\r\n                    });\r\n                }\r\n            }, 2000);\r\n        },\r\n        handleReEdit(row) {\r\n            this.$router.push(\"/NewReserve\")\r\n            console.log(row.sitId)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n\r\n<style>\r\n.text {\r\n    font-size: 14px;\r\n}\r\n\r\n.item {\r\n    margin-bottom: 18px;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n    display: table;\r\n    content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n    clear: both\r\n}\r\n\r\n.box-card {\r\n    width: 100%;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.headerBg {\r\n    background: #eee !important;\r\n}\r\n</style>"]}]}