{"remainingRequest":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\babel-loader\\lib\\index.js!F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\src\\views\\MyReserve.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\src\\views\\MyReserve.vue","mtime":1684921698000},{"path":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\babel.config.js","mtime":1684482910000},{"path":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1684483040000},{"path":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\软件项目过程管理\\课程实践\\最终版\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1684483040000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IE1hcExvYWRlciBmcm9tICIuLi91dGlscy9nYW9kZSI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTXlSZXNlcnZlIiwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYmxlRGF0YVRvZGF5OiBbXSwKICAgICAgdGFibGVEYXRhRnV0dXJlOiBbXSwKICAgICAgdGFibGVEYXRhRXhwaXJlZDogW10sCiAgICAgIHBhZ2VOdW06IDEsCiAgICAgIHBhZ2VTaXplOiAtMSwKICAgICAgdXNlcm5hbWU6IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkudXNlcm5hbWUsCiAgICAgIGZ1bGxzY3JlZW5Mb2FkaW5nOiBmYWxzZQogICAgfTsKICB9LAoKICBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkKCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgaGFuZGxlQ2FuY2VsKGlkKSB7CiAgICAgIHRoaXMucmVxdWVzdC5wb3N0KCIvcmVzZXJ2ZS9jYW5jZWxfcmVzZXJ2ZSIsIHsKICAgICAgICBpZDogaWQKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgIGlmIChyZXMuY29kZSA9PT0gJzIwMCcpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5Y+W5raI5oiQ5YqfIik7CiAgICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5Y+W5raI5aSx6LSlIik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgbG9hZCgpIHsKICAgICAgdGhpcy5yZXF1ZXN0LmdldCgiL3Jlc2VydmUvY2hlY2tfcmVzZXJ2ZSIsIHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHBhZ2VOdW06IHRoaXMucGFnZU51bSwKICAgICAgICAgIHBhZ2VTaXplOiB0aGlzLnBhZ2VTaXplLAogICAgICAgICAgdXNlcm5hbWU6IHRoaXMudXNlcm5hbWUKICAgICAgICB9CiAgICAgIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLnRhYmxlRGF0YVRvZGF5ID0gW107CiAgICAgICAgdGhpcy50YWJsZURhdGFGdXR1cmUgPSBbXTsKICAgICAgICB0aGlzLnRhYmxlRGF0YUV4cGlyZWQgPSBbXTsKICAgICAgICBsZXQgdGFibGVEYXRhID0gcmVzLmRhdGEucmVjb3JkczsKICAgICAgICBsZXQgdG90YWwgPSB0YWJsZURhdGEubGVuZ3RoOwoKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRvdGFsOyBpKyspIHsKICAgICAgICAgIGlmICh0YWJsZURhdGFbaV0uYnJlYWtDb250cmFjdCA9PT0gdHJ1ZSB8fCB0YWJsZURhdGFbaV0uY2FuY2xlID09PSB0cnVlIHx8IHRhYmxlRGF0YVtpXS5jaGVja0luVGltZSA9PT0gdHJ1ZSkgewogICAgICAgICAgICB0aGlzLnRhYmxlRGF0YUV4cGlyZWQucHVzaCh0YWJsZURhdGFbaV0pOwogICAgICAgICAgfSBlbHNlIGlmICh0YWJsZURhdGFbaV0uYnJlYWtDb250cmFjdCA9PT0gZmFsc2UgJiYgdGFibGVEYXRhW2ldLmNhbmNsZSA9PT0gZmFsc2UgJiYgdGFibGVEYXRhW2ldLmNoZWNrSW5UaW1lID09PSBmYWxzZSkgewogICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSB0YWJsZURhdGFbaV0uc3RhcnRUaW1lLnNwbGl0KCIgIilbMF07CiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7CiAgICAgICAgICAgIGNvbnN0IG1vbnRoID0gU3RyaW5nKGN1cnJlbnREYXRlLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICBjb25zdCBkYXkgPSBTdHJpbmcoY3VycmVudERhdGUuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICAgICAgICBjb25zdCB0b2RheURhdGUgPSBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gOwoKICAgICAgICAgICAgaWYgKHN0YXJ0VGltZSA9PT0gdG9kYXlEYXRlKSB7CiAgICAgICAgICAgICAgdGhpcy50YWJsZURhdGFUb2RheS5wdXNoKHRhYmxlRGF0YVtpXSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy50YWJsZURhdGFGdXR1cmUucHVzaCh0YWJsZURhdGFbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCgogICAgaGFuZGxlU2lnbkluKHJvdykgewogICAgICB0aGlzLmZ1bGxzY3JlZW5Mb2FkaW5nID0gdHJ1ZTsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpOwogICAgICAgIGNvbnN0IGN1cnJlbnRIb3VycyA9IGN1cnJlbnREYXRlLmdldEhvdXJzKCk7CiAgICAgICAgY29uc3QgY3VycmVudE1pbnV0ZXMgPSBjdXJyZW50RGF0ZS5nZXRNaW51dGVzKCk7CiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcm93LnN0YXJ0VGltZS5zcGxpdCgiICIpWzFdOwogICAgICAgIGNvbnN0IHN0YXJ0SG91ciA9IHN0YXJ0VGltZS5zcGxpdCgiOiIpWzBdOwogICAgICAgIGNvbnN0IHN0YXJ0TWludXRlID0gc3RhcnRUaW1lLnNwbGl0KCI6IilbMV07CiAgICAgICAgY29uc3QgdGltZVZhbHVlMSA9IHBhcnNlSW50KGN1cnJlbnRIb3VycywgMTApICogNjAgKyBwYXJzZUludChjdXJyZW50TWludXRlcywgMTApOwogICAgICAgIGNvbnN0IHRpbWVWYWx1ZTIgPSBwYXJzZUludChzdGFydEhvdXIsIDEwKSAqIDYwICsgcGFyc2VJbnQoc3RhcnRNaW51dGUsIDEwKTsKICAgICAgICBjb25zdCBtaW51dGVEaWZmZXJlbmNlID0gdGltZVZhbHVlMSAtIHRpbWVWYWx1ZTI7CgogICAgICAgIGlmIChtaW51dGVEaWZmZXJlbmNlIDwgLTUpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuacquWIsOetvuWIsOaXtumXtO+8jOivt+WcqOW8gOWni+aXtumXtOWJjeS6lOWIhumSn+iHs+WQjuWNgeS6lOWIhumSn+WGheetvuWIsCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnJlcXVlc3QucG9zdCgiL3Jlc2VydmUvY29uZmlybV9yZXNlcnZlIiwgewogICAgICAgICAgICBpZDogcm93LmlkCiAgICAgICAgICB9KS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCLlvIDlp4vlrprkvY3vvIEiKTsKICAgICAgICAgICAgTWFwTG9hZGVyKCk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09ICcyMDAnKSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLnrb7liLDmiJDlip8iKTsKICAgICAgICAgICAgICB0aGlzLmxvYWQoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLnrb7liLDlpLHotKUiKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmZ1bGxzY3JlZW5Mb2FkaW5nID0gZmFsc2U7CiAgICAgIH0sIDIwMDApOwogICAgfSwKCiAgICBoYW5kbGVSZUVkaXQocm93KSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvTmV3UmVzZXJ2ZSIpOwogICAgICBjb25zb2xlLmxvZyhyb3cuc2l0SWQpOwogICAgfQoKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgIA;AACA;EACAA,iBADA;;EAEAC;IACA;MACAC,kBADA;MAEAC,mBAFA;MAGAC,oBAHA;MAIAC,UAJA;MAKAC,YALA;MAMAC,2DANA;MAOAC;IAPA;EASA,CAZA;;EAaAC;IACA;EACA,CAfA;;EAgBAC;IACAC;MACA;QACAC;MADA,GAEAC,IAFA,CAEAC;QACAC;;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;MACA,CAVA;IAWA,CAbA;;IAcAC;MACA;QACAC;UACAZ,qBADA;UAEAC,uBAFA;UAGAC;QAHA;MADA,GAMAM,IANA,CAMAC;QACA;QACA;QACA;QACA;QACA;;QACA;UACA;YACA;UACA,CAFA,MAEA;YACA;YACA;YACA;YACA;YACA;YACA;;YACA;cACA;YACA,CAFA,MAEA;cACA;YACA;UACA;QACA;MACA,CA7BA;IA+BA,CA9CA;;IA+CAI;MACA;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QACA;UACA;QACA,CAFA,MAEA;UACA;YACAP;UADA,GAEAC,IAFA,CAEAC;YACAC;YACAK;YACAL;;YACA;cACA;cACA;YACA,CAHA,MAGA;cACA;YACA;UACA,CAZA;QAaA;;QACA;MACA,CA5BA,EA4BA,IA5BA;IA+BA,CAhFA;;IAiFAM;MACA;MACAN;IACA;;EApFA;AAhBA","names":["name","data","tableDataToday","tableDataFuture","tableDataExpired","pageNum","pageSize","username","fullscreenLoading","created","methods","handleCancel","id","then","res","console","load","params","handleSignIn","setTimeout","MapLoader","handleReEdit"],"sourceRoot":"src/views","sources":["MyReserve.vue"],"sourcesContent":["<template>\n    <div>\n        <el-card class=\"box-card\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>今日预约</span>\n            </div>\n            <el-table :data=\"tableDataToday\" border stripe>\n\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\n                </el-table-column>\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\n                </el-table-column>\n                <el-table-column prop=\"sitId\" label=\"座位号\">\n                </el-table-column>\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\n                </el-table-column>\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\n                </el-table-column>\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\n                </el-table-column>\n\n                <el-table-column prop=\"option\" label=\"操作\">\n                    <template slot-scope=\"scope\">\n                        <el-button type=\"primary\" v-loading.fullscreen.lock=\"fullscreenLoading\"\n                            @click=\"handleSignIn(scope.row)\">签到 <i class=\"el-icon-s-claim\"></i></el-button>\n\n                        <el-popconfirm class=\"ml-5\" confirm-button-text='确定' cancel-button-text='我再想想' icon=\"el-icon-info\"\n                            icon-color=\"red\" title=\"您确定取消预约吗？\" @confirm=\"handleCancel(scope.row.id)\">\n                            <el-button type=\"danger\" slot=\"reference\">取消预约 <i\n                                    class=\"el-icon-remove-outline\"></i></el-button>\n                        </el-popconfirm>\n                    </template>\n                </el-table-column>\n            </el-table>\n\n        </el-card>\n\n        <el-card class=\"box-card\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>未来预约</span>\n\n            </div>\n\n            <el-table :data=\"tableDataFuture\" border stripe>\n\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\n                </el-table-column>\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\n                </el-table-column>\n                <el-table-column prop=\"sitId\" label=\"座位号\">\n                </el-table-column>\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\n                </el-table-column>\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\n                </el-table-column>\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\n                </el-table-column>\n\n                <el-table-column prop=\"option\" label=\"操作\">\n                    <template slot-scope=\"scope\">\n\n                        <el-popconfirm class=\"ml-5\" confirm-button-text='确定' cancel-button-text='我再想想' icon=\"el-icon-info\"\n                            icon-color=\"red\" title=\"您确定取消预约吗？\" @confirm=\"handleCancel(scope.row.id)\">\n\n                            <el-button type=\"danger\" slot=\"reference\">取消预约 <i\n                                    class=\"el-icon-remove-outline\"></i></el-button>\n\n                        </el-popconfirm>\n                    </template>\n                </el-table-column>\n            </el-table>\n\n        </el-card>\n\n        <el-card class=\"box-card\">\n            <div slot=\"header\" class=\"clearfix\">\n                <span>已过期预约</span>\n\n            </div>\n            <el-table :data=\"tableDataExpired\" border stripe>\n\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\n                </el-table-column>\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\n                </el-table-column>\n                <el-table-column prop=\"sitId\" label=\"座位号\">\n                </el-table-column>\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\n                </el-table-column>\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\n                </el-table-column>\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\n                </el-table-column>\n                <el-table-column label=\"是否签到\">\n                    <template slot-scope=\"scope\">\n                        <el-switch v-model=\"scope.row.checkInTime\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\n                            disabled></el-switch>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"是否取消\">\n                    <template slot-scope=\"scope\">\n                        <el-switch v-model=\"scope.row.cancle\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\n                            disabled></el-switch>\n                    </template>\n                </el-table-column>\n                <el-table-column label=\"是否违约\">\n                    <template slot-scope=\"scope\">\n                        <el-switch v-model=\"scope.row.breakContract\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\n                            disabled></el-switch>\n                    </template>\n                </el-table-column>\n                <el-table-column prop=\"option\" label=\"操作\">\n                    <template slot-scope=\"scope\">\n                        <router-link :to=\"{name: '座位预定', params: {id: scope.row.sitId}}\">\n                            <el-button>\n                                再次预约 \n                                <i class=\"el-icon-s-check\"></i>\n                            </el-button>\n                        </router-link>\n                    </template>\n                </el-table-column>\n            </el-table>\n\n        </el-card>\n    </div>\n</template>\n  \n<script>\nimport MapLoader from \"../utils/gaode\"\nexport default {\n    name: \"MyReserve\",\n    data() {\n        return {\n            tableDataToday: [],\n            tableDataFuture: [],\n            tableDataExpired: [],\n            pageNum: 1,\n            pageSize: -1,\n            username: JSON.parse(localStorage.getItem(\"user\")).username,\n            fullscreenLoading: false,\n        }\n    },\n    created() {\n        this.load()\n    },\n    methods: {\n        handleCancel(id) {\n            this.request.post(\"/reserve/cancel_reserve\", {\n                id: id\n            }).then(res => {\n                console.log(res)\n                if (res.code === '200') {\n                    this.$message.success(\"取消成功\")\n                    this.load()\n                } else {\n                    this.$message.error(\"取消失败\")\n                }\n            })\n        },\n        load() {\n            this.request.get(\"/reserve/check_reserve\", {\n                params: {\n                    pageNum: this.pageNum,\n                    pageSize: this.pageSize,\n                    username: this.username\n                }\n            }).then(res => {\n                this.tableDataToday = []\n                this.tableDataFuture = []\n                this.tableDataExpired = []\n                let tableData = res.data.records\n                let total = tableData.length\n                for (let i = 0; i < total; i++) {\n                    if (tableData[i].breakContract === true || tableData[i].cancle === true || tableData[i].checkInTime === true) {\n                        this.tableDataExpired.push(tableData[i])\n                    } else if (tableData[i].breakContract === false && tableData[i].cancle === false && tableData[i].checkInTime === false) {\n                        const startTime = tableData[i].startTime.split(\" \")[0]\n                        const currentDate = new Date();\n                        const year = currentDate.getFullYear();\n                        const month = String(currentDate.getMonth() + 1).padStart(2, '0');\n                        const day = String(currentDate.getDate()).padStart(2, '0');\n                        const todayDate = `${year}-${month}-${day}`;\n                        if (startTime === todayDate) {\n                            this.tableDataToday.push(tableData[i])\n                        } else {\n                            this.tableDataFuture.push(tableData[i])\n                        }\n                    }\n                }\n            })\n\n        },\n        handleSignIn(row) {\n            this.fullscreenLoading = true\n            setTimeout(() => {\n                const currentDate = new Date()\n                const currentHours = currentDate.getHours()\n                const currentMinutes = currentDate.getMinutes()\n                const startTime = row.startTime.split(\" \")[1]\n                const startHour = startTime.split(\":\")[0]\n                const startMinute = startTime.split(\":\")[1]\n                const timeValue1 = parseInt(currentHours, 10) * 60 + parseInt(currentMinutes, 10);\n                const timeValue2 = parseInt(startHour, 10) * 60 + parseInt(startMinute, 10);\n                const minuteDifference = timeValue1 - timeValue2;\n                if (minuteDifference < -5) {\n                    this.$message.error(\"未到签到时间，请在开始时间前五分钟至后十五分钟内签到\")\n                } else {\n                    this.request.post(\"/reserve/confirm_reserve\", {\n                        id: row.id\n                    }).then(res => {\n                        console.log(\"开始定位！\")\n                        MapLoader()\n                        console.log(res)\n                        if (res.code === '200') {\n                            this.$message.success(\"签到成功\")\n                            this.load()\n                        } else {\n                            this.$message.error(\"签到失败\")\n                        }\n                    })\n                }\n                this.fullscreenLoading = false\n            }, 2000);\n\n\n        },\n        handleReEdit(row) {\n            this.$router.push(\"/NewReserve\")\n            console.log(row.sitId)\n        }\n    }\n}\n</script>\n\n\n<style>\n.text {\n    font-size: 14px;\n}\n\n.item {\n    margin-bottom: 18px;\n}\n\n.clearfix:before,\n.clearfix:after {\n    display: table;\n    content: \"\";\n}\n\n.clearfix:after {\n    clear: both\n}\n\n.box-card {\n    width: 100%;\n    margin-bottom: 20px;\n}\n\n.headerBg {\n    background: #eee !important;\n}\n</style>"]}]}