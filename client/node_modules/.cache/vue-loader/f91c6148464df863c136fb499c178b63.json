{"remainingRequest":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\Fudan course\\software_management\\iBooking\\client\\src\\views\\MyReserve.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\src\\views\\MyReserve.vue","mtime":1715762069694},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1684483040000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1684483038000},{"path":"F:\\Fudan course\\software_management\\iBooking\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1684483040000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgTWFwTG9hZGVyIGZyb20gIi4uL3V0aWxzL2dhb2RlIg0KZXhwb3J0IGRlZmF1bHQgew0KICAgIG5hbWU6ICJNeVJlc2VydmUiLA0KICAgIGRhdGEoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICB0YWJsZURhdGFUb2RheTogW10sDQogICAgICAgICAgICB0YWJsZURhdGFGdXR1cmU6IFtdLA0KICAgICAgICAgICAgdGFibGVEYXRhRXhwaXJlZDogW10sDQogICAgICAgICAgICBwYWdlTnVtOiAxLA0KICAgICAgICAgICAgcGFnZVNpemU6IC0xLA0KICAgICAgICAgICAgdXNlcm5hbWU6IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXIiKSkudXNlcm5hbWUsDQogICAgICAgICAgICBmdWxsc2NyZWVuTG9hZGluZzogZmFsc2UsDQogICAgICAgIH0NCiAgICB9LA0KICAgIGNyZWF0ZWQoKSB7DQogICAgICAgIHRoaXMubG9hZCgpDQogICAgfSwNCiAgICBtZXRob2RzOiB7DQogICAgICAgIGhhbmRsZUNhbmNlbChpZCkgew0KICAgICAgICAgICAgdGhpcy5yZXF1ZXN0LnBvc3QoIi9yZXNlcnZlL2NhbmNlbF9yZXNlcnZlIiwgew0KICAgICAgICAgICAgICAgIGlkOiBpZA0KICAgICAgICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcykNCiAgICAgICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09ICcyMDAnKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5Y+W5raI5oiQ5YqfIikNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkKCkNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLlj5bmtojlpLHotKUiKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgIH0sDQogICAgICAgIGxvYWQoKSB7DQogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMucmVxdWVzdC5nZXQoIi9yZXNlcnZlL2NoZWNrX3Jlc2VydmUiLCB7DQogICAgICAgICAgICAgICAgICAgIHBhcmFtczogew0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZU51bTogdGhpcy5wYWdlTnVtLA0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsDQogICAgICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdGhpcy51c2VybmFtZQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YVRvZGF5ID0gW107DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGFibGVEYXRhRnV0dXJlID0gW107DQogICAgICAgICAgICAgICAgICAgIHRoaXMudGFibGVEYXRhRXhwaXJlZCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICBsZXQgdGFibGVEYXRhID0gcmVzLmRhdGEucmVjb3JkczsNCiAgICAgICAgICAgICAgICAgICAgbGV0IHRvdGFsID0gdGFibGVEYXRhLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0b3RhbDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFibGVEYXRhW2ldLmJyZWFrQ29udHJhY3QgPT09IHRydWUgfHwgdGFibGVEYXRhW2ldLmNhbmNsZSA9PT0gdHJ1ZSB8fCB0YWJsZURhdGFbaV0uY2hlY2tJblRpbWUgPT09IHRydWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YUV4cGlyZWQucHVzaCh0YWJsZURhdGFbaV0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0YWJsZURhdGFbaV0uYnJlYWtDb250cmFjdCA9PT0gZmFsc2UgJiYgdGFibGVEYXRhW2ldLmNhbmNsZSA9PT0gZmFsc2UgJiYgdGFibGVEYXRhW2ldLmNoZWNrSW5UaW1lID09PSBmYWxzZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHRhYmxlRGF0YVtpXS5zdGFydFRpbWUuc3BsaXQoIiAiKVswXTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgeWVhciA9IGN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9udGggPSBTdHJpbmcoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsICcwJyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF5ID0gU3RyaW5nKGN1cnJlbnREYXRlLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0b2RheURhdGUgPSBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydFRpbWUgPT09IHRvZGF5RGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YVRvZGF5LnB1c2godGFibGVEYXRhW2ldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhYmxlRGF0YUZ1dHVyZS5wdXNoKHRhYmxlRGF0YVtpXSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTsNCiAgICAgICAgICAgICAgICB9KS5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgaGFuZGxlU2lnbkluKHJvdykgew0KICAgICAgICAgICAgdGhpcy5mdWxsc2NyZWVuTG9hZGluZyA9IHRydWU7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEhvdXJzID0gY3VycmVudERhdGUuZ2V0SG91cnMoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBjdXJyZW50TWludXRlcyA9IGN1cnJlbnREYXRlLmdldE1pbnV0ZXMoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBzdGFydFRpbWUgPSByb3cuc3RhcnRUaW1lLnNwbGl0KCIgIilbMV07DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRIb3VyID0gc3RhcnRUaW1lLnNwbGl0KCI6IilbMF07DQogICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRNaW51dGUgPSBzdGFydFRpbWUuc3BsaXQoIjoiKVsxXTsNCiAgICAgICAgICAgICAgICBjb25zdCB0aW1lVmFsdWUxID0gcGFyc2VJbnQoY3VycmVudEhvdXJzLCAxMCkgKiA2MCArIHBhcnNlSW50KGN1cnJlbnRNaW51dGVzLCAxMCk7DQogICAgICAgICAgICAgICAgY29uc3QgdGltZVZhbHVlMiA9IHBhcnNlSW50KHN0YXJ0SG91ciwgMTApICogNjAgKyBwYXJzZUludChzdGFydE1pbnV0ZSwgMTApOw0KICAgICAgICAgICAgICAgIGNvbnN0IG1pbnV0ZURpZmZlcmVuY2UgPSB0aW1lVmFsdWUxIC0gdGltZVZhbHVlMjsNCg0KICAgICAgICAgICAgICAgIGlmIChtaW51dGVEaWZmZXJlbmNlIDwgLTUpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigi5pyq5Yiw562+5Yiw5pe26Ze077yM6K+35Zyo5byA5aeL5pe26Ze05YmN5LqU5YiG6ZKf6Iez5ZCO5Y2B5LqU5YiG6ZKf5YaF562+5YiwIik7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZnVsbHNjcmVlbkxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi5byA5aeL5a6a5L2N77yBIik7DQogICAgICAgICAgICAgICAgICAgIE1hcExvYWRlcigpLnRoZW4oaXNXaXRoaW5EaXN0YW5jZSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNXaXRoaW5EaXN0YW5jZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJvdy5pZCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVxdWVzdC5wb3N0KCIvcmVzZXJ2ZS9jb25maXJtX3Jlc2VydmUiLCB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiByb3cuaWQNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCLnrb7liLDlpLHotKXvvIzmgqjkuI3lnKjmjIflrprkvY3nva7ojIPlm7TlhoUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMjAwJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi562+5Yiw5oiQ5YqfIik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMubG9hZCgpOyAvLyDph43mlrDliqDovb3mlbDmja7ku6Xmm7TmlrDnlYzpnaINCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCLnrb7liLDlpLHotKUiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bGxzY3JlZW5Mb2FkaW5nID0gZmFsc2U7IC8vIOWcqOmHjeaWsOWKoOi9veaVsOaNruWujOaIkOWQjuiuvue9ruS4umZhbHNlDQogICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyb3IubWVzc2FnZSB8fCAi562+5Yiw5aSx6LSlIik7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZ1bGxzY3JlZW5Mb2FkaW5nID0gZmFsc2U7IC8vIOehruS/neWcqOaJgOacieaTjeS9nOWujOaIkOWQjuiuvue9ruS4umZhbHNlDQogICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sIDIwMDApOw0KICAgICAgICB9LA0KICAgICAgICBoYW5kbGVSZUVkaXQocm93KSB7DQogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL05ld1Jlc2VydmUiKQ0KICAgICAgICAgICAgY29uc29sZS5sb2cocm93LnNpdElkKQ0KICAgICAgICB9DQogICAgfQ0KfQ0K"},{"version":3,"sources":["MyReserve.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"MyReserve.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div>\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>今日预约</span>\r\n            </div>\r\n            <el-table :data=\"tableDataToday\" border stripe>\r\n\r\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"sitId\" label=\"座位号\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\r\n                </el-table-column>\r\n\r\n                <el-table-column prop=\"option\" label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-button type=\"primary\" v-loading.fullscreen.lock=\"fullscreenLoading\"\r\n                            @click=\"handleSignIn(scope.row)\">签到 <i class=\"el-icon-s-claim\"></i></el-button>\r\n\r\n                        <el-popconfirm class=\"ml-5\" confirm-button-text='确定' cancel-button-text='我再想想' icon=\"el-icon-info\"\r\n                            icon-color=\"red\" title=\"您确定取消预约吗？\" @confirm=\"handleCancel(scope.row.id)\">\r\n                            <el-button type=\"danger\" slot=\"reference\">取消预约 <i\r\n                                    class=\"el-icon-remove-outline\"></i></el-button>\r\n                        </el-popconfirm>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n        </el-card>\r\n\r\n        <el-card class=\"box-card\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>未来预约</span>\r\n\r\n            </div>\r\n\r\n            <el-table :data=\"tableDataFuture\" border stripe>\r\n\r\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"sitId\" label=\"座位号\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\r\n                </el-table-column>\r\n\r\n                <el-table-column prop=\"option\" label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n\r\n                        <el-popconfirm class=\"ml-5\" confirm-button-text='确定' cancel-button-text='我再想想' icon=\"el-icon-info\"\r\n                            icon-color=\"red\" title=\"您确定取消预约吗？\" @confirm=\"handleCancel(scope.row.id)\">\r\n\r\n                            <el-button type=\"danger\" slot=\"reference\">取消预约 <i\r\n                                    class=\"el-icon-remove-outline\"></i></el-button>\r\n\r\n                        </el-popconfirm>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n        </el-card>\r\n\r\n        <el-card class=\"box-card\" v-if=\"userRole === 'ROLE_ADMIN'\">\r\n            <div slot=\"header\" class=\"clearfix\">\r\n                <span>已过期预约</span>\r\n\r\n            </div>\r\n            <el-table :data=\"tableDataExpired\" border stripe>\r\n\r\n                <el-table-column prop=\"id\" label=\"预约单号\" width=\"140\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"roomId\" label=\"教室名称\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"sitId\" label=\"座位号\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"startTime\" label=\"开始时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"endTime\" label=\"结束时间\">\r\n                </el-table-column>\r\n                <el-table-column prop=\"reservedTime\" label=\"预约订单时间\">\r\n                </el-table-column>\r\n                <el-table-column label=\"是否签到\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-switch v-model=\"scope.row.checkInTime\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\r\n                            disabled></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"是否取消\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-switch v-model=\"scope.row.cancle\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\r\n                            disabled></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column label=\"是否违约\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-switch v-model=\"scope.row.breakContract\" active-color=\"#13ce66\" inactive-color=\"#ccc\"\r\n                            disabled></el-switch>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"option\" label=\"操作\">\r\n                    <template slot-scope=\"scope\">\r\n                        <router-link :to=\"{name: '座位预定', params: {id: scope.row.sitId}}\">\r\n                            <el-button>\r\n                                再次预约 \r\n                                <i class=\"el-icon-s-check\"></i>\r\n                            </el-button>\r\n                        </router-link>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n        </el-card>\r\n    </div>\r\n</template>\r\n  \r\n<script>\r\nimport MapLoader from \"../utils/gaode\"\r\nexport default {\r\n    name: \"MyReserve\",\r\n    data() {\r\n        return {\r\n            tableDataToday: [],\r\n            tableDataFuture: [],\r\n            tableDataExpired: [],\r\n            pageNum: 1,\r\n            pageSize: -1,\r\n            username: JSON.parse(localStorage.getItem(\"user\")).username,\r\n            fullscreenLoading: false,\r\n        }\r\n    },\r\n    created() {\r\n        this.load()\r\n    },\r\n    methods: {\r\n        handleCancel(id) {\r\n            this.request.post(\"/reserve/cancel_reserve\", {\r\n                id: id\r\n            }).then(res => {\r\n                console.log(res)\r\n                if (res.code === '200') {\r\n                    this.$message.success(\"取消成功\")\r\n                    this.load()\r\n                } else {\r\n                    this.$message.error(\"取消失败\")\r\n                }\r\n            })\r\n        },\r\n        load() {\r\n            return new Promise((resolve, reject) => {\r\n                this.request.get(\"/reserve/check_reserve\", {\r\n                    params: {\r\n                        pageNum: this.pageNum,\r\n                        pageSize: this.pageSize,\r\n                        username: this.username\r\n                    }\r\n                }).then(res => {\r\n                    this.tableDataToday = [];\r\n                    this.tableDataFuture = [];\r\n                    this.tableDataExpired = [];\r\n                    let tableData = res.data.records;\r\n                    let total = tableData.length;\r\n                    for (let i = 0; i < total; i++) {\r\n                        if (tableData[i].breakContract === true || tableData[i].cancle === true || tableData[i].checkInTime === true) {\r\n                            this.tableDataExpired.push(tableData[i]);\r\n                        } else if (tableData[i].breakContract === false && tableData[i].cancle === false && tableData[i].checkInTime === false) {\r\n                            const startTime = tableData[i].startTime.split(\" \")[0];\r\n                            const currentDate = new Date();\r\n                            const year = currentDate.getFullYear();\r\n                            const month = String(currentDate.getMonth() + 1).padStart(2, '0');\r\n                            const day = String(currentDate.getDate()).padStart(2, '0');\r\n                            const todayDate = `${year}-${month}-${day}`;\r\n                            if (startTime === todayDate) {\r\n                                this.tableDataToday.push(tableData[i]);\r\n                            } else {\r\n                                this.tableDataFuture.push(tableData[i]);\r\n                            }\r\n                        }\r\n                    }\r\n                    resolve();\r\n                }).catch(error => {\r\n                    reject(error);\r\n                });\r\n            });\r\n        },\r\n        handleSignIn(row) {\r\n            this.fullscreenLoading = true;\r\n            setTimeout(() => {\r\n                const currentDate = new Date();\r\n                const currentHours = currentDate.getHours();\r\n                const currentMinutes = currentDate.getMinutes();\r\n                const startTime = row.startTime.split(\" \")[1];\r\n                const startHour = startTime.split(\":\")[0];\r\n                const startMinute = startTime.split(\":\")[1];\r\n                const timeValue1 = parseInt(currentHours, 10) * 60 + parseInt(currentMinutes, 10);\r\n                const timeValue2 = parseInt(startHour, 10) * 60 + parseInt(startMinute, 10);\r\n                const minuteDifference = timeValue1 - timeValue2;\r\n\r\n                if (minuteDifference < -5) {\r\n                    this.$message.error(\"未到签到时间，请在开始时间前五分钟至后十五分钟内签到\");\r\n                    this.fullscreenLoading = false;\r\n                } else {\r\n                    console.log(\"开始定位！\");\r\n                    MapLoader().then(isWithinDistance => {\r\n                        if (isWithinDistance) {\r\n                            console.log(row.id);\r\n                            return this.request.post(\"/reserve/confirm_reserve\", {\r\n                                id: row.id\r\n                            });\r\n                        } else {\r\n                            throw new Error(\"签到失败，您不在指定位置范围内\");\r\n                        }\r\n                    }).then(res => {\r\n                        if (res.code === '200') {\r\n                            this.$message.success(\"签到成功\");\r\n                            return this.load(); // 重新加载数据以更新界面\r\n                        } else {\r\n                            throw new Error(\"签到失败\");\r\n                        }\r\n                    }).then(() => {\r\n                        this.fullscreenLoading = false; // 在重新加载数据完成后设置为false\r\n                    }).catch(error => {\r\n                        this.$message.error(error.message || \"签到失败\");\r\n                        this.fullscreenLoading = false; // 确保在所有操作完成后设置为false\r\n                    });\r\n                }\r\n            }, 2000);\r\n        },\r\n        handleReEdit(row) {\r\n            this.$router.push(\"/NewReserve\")\r\n            console.log(row.sitId)\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n\r\n<style>\r\n.text {\r\n    font-size: 14px;\r\n}\r\n\r\n.item {\r\n    margin-bottom: 18px;\r\n}\r\n\r\n.clearfix:before,\r\n.clearfix:after {\r\n    display: table;\r\n    content: \"\";\r\n}\r\n\r\n.clearfix:after {\r\n    clear: both\r\n}\r\n\r\n.box-card {\r\n    width: 100%;\r\n    margin-bottom: 20px;\r\n}\r\n\r\n.headerBg {\r\n    background: #eee !important;\r\n}\r\n</style>"]}]}